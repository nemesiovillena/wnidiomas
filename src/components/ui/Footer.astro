---
import { getSiteSettings } from '../../lib/payload-local';

// Query to fetch global site settings
const settings = await getSiteSettings();

const currentYear = new Date().getFullYear();
---

<footer class="bg-matte-black text-white/50 border-t border-white/5">
  <div class="max-w-7xl mx-auto px-12 py-24 flex flex-col gap-20">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-16 text-center md:text-left">
      
      {/* Brand & Contact */}
      <div class="flex flex-col gap-6">
        <h2 class="font-display text-4xl font-black text-white">
          {settings?.title || "Restaurante Warynessy"}
        </h2>
        <p class="text-base leading-relaxed">
          {settings?.contact?.address && (
            <>{settings.contact.address}<br/>{settings.contact.postalCode} {settings.contact.city}, {settings?.contact?.province || 'Alicante'}<br/></>
          )}
          {settings?.contact?.phone && <a href={`tel:${settings.contact.phone}`} class="hover:text-white transition-colors">{settings.contact.phone}</a>}
        </p>
      </div>

      {/* Certifications (Central) */}
      <div class="flex flex-col items-center gap-10">
        <div class="flex flex-wrap justify-center gap-8 opacity-40 grayscale hover:grayscale-0 transition-all duration-700">
          {settings?.footerLogos ? (
            settings.footerLogos.map((item: any) => (
              item.logo?.url ? (
                <div class="flex flex-col items-center gap-2">
                  <img src={item.logo.url} alt={item.alt || "Certificación"} class="h-12 w-auto object-contain" />
                  <span class="text-[9px] font-bold tracking-widest uppercase">{item.alt || "Sello"}</span>
                </div>
              ) : null
            ))
          ) : (
             /* Fallback hardcoded if no CMS data */
            <>
              <div class="flex flex-col items-center gap-2">
                <span class="material-symbols-outlined text-5xl">wine_bar</span>
                <span class="text-[9px] font-bold tracking-widest uppercase">Wine Route</span>
              </div>
              <div class="flex flex-col items-center gap-2">
                <span class="material-symbols-outlined text-5xl">verified</span>
                <span class="text-[9px] font-bold tracking-widest uppercase">SICTED</span>
              </div>
            </>
          )}
        </div>
      </div>

      {/* Social & Reservation (Right) */}
      <div class="flex flex-col items-center md:items-end gap-8">
        <div class="flex gap-6 text-white/80">
          {settings?.socialMedia?.tripadvisor && (
            <a href={settings.socialMedia.tripadvisor} target="_blank" rel="noopener noreferrer" class="hover:text-primary transition-colors" aria-label="Tripadvisor">
              <span class="material-symbols-outlined text-3xl">social_leaderboard</span>
            </a>
          )}
          {settings?.socialMedia?.instagram && (
            <a href={settings.socialMedia.instagram} target="_blank" rel="noopener noreferrer" class="hover:text-primary transition-colors" aria-label="Instagram">
              <span class="material-symbols-outlined text-3xl">camera_alt</span>
            </a>
          )}
          {settings?.contact?.email && (
            <a href={`mailto:${settings.contact.email}`} class="hover:text-primary transition-colors" aria-label="Email">
              <span class="material-symbols-outlined text-3xl">alternate_email</span>
            </a>
          )}
        </div>
        <a href="/reservas" class="text-sm font-bold tracking-[0.3em] uppercase hover:text-primary transition-colors border-b border-transparent hover:border-primary pb-1">
          Reserve your experience
        </a>
      </div>
    </div>

    <div class="w-full h-px bg-white/5"></div>

    <div class="flex flex-col md:flex-row justify-between items-center gap-6 text-xs tracking-widest uppercase">
      <p>
        {settings?.copyright || `© ${currentYear} Restaurante Warynessy. All rights reserved.`}
      </p>
      <div class="flex gap-8 text-[10px]">
        <a class="hover:text-white transition-colors" href="/aviso-legal">Legal Notice</a>
        <a class="hover:text-white transition-colors" href="/privacidad">Privacy Policy</a>
        <a class="hover:text-white transition-colors" href="/cookies">Cookies</a>
      </div>
    </div>
  </div>
</footer>

{/* Floating Reservation Button */}
<div class="fixed bottom-8 right-8 z-[60]">
  <a href="/reservas" class="group bg-primary text-white w-14 h-14 md:w-16 md:h-16 rounded-full shadow-2xl flex items-center justify-center transition-all hover:w-48 overflow-hidden active:scale-95 ring-4 ring-white/10 hover:ring-primary/30">
    <span class="material-symbols-outlined shrink-0 text-white text-2xl md:text-3xl">calendar_add_on</span>
    <span class="ml-3 whitespace-nowrap opacity-0 w-0 transition-opacity duration-300 group-hover:opacity-100 group-hover:w-auto uppercase font-bold text-xs tracking-widest text-white delay-100">Reservar Mesa</span>
  </a>
</div>
