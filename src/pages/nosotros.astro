---
import MainLayout from '../layouts/MainLayout.astro';
import Section from '../components/ui/Section.astro';
import Container from '../components/ui/Container.astro';
import Button from '../components/ui/Button.astro';
import ResponsiveImage from '../components/ui/ResponsiveImage.astro';
import { getSiteSettings, getPaginaBySlug } from '../lib/payload-local';

const siteSettings = await getSiteSettings();
const pageData = await getPaginaBySlug('nosotros');

const pageTitle = pageData?.metaTitle || `Nosotros | ${siteSettings?.title || "Warynessy"}`;
const pageDescription = pageData?.metaDescription || undefined;

// Imagen Hero desde el CMS o fallback
const heroImg = typeof pageData?.heroImage === 'object' && pageData?.heroImage?.url 
  ? pageData.heroImage.url 
  : 'https://images.unsplash.com/photo-1552566626-52f8b828add9?auto=format&fit=crop&q=80';
---

<MainLayout title={pageTitle} description={pageDescription}>
  
  {/* Hero Section */}
  <section class="relative h-[60vh] w-full overflow-hidden">
    <div 
      class="absolute inset-0 bg-cover bg-center"
      style={`background-image: url('${heroImg}');`}
    ></div>
    <div class="absolute inset-0 bg-black/60"></div>
    <Container class="relative h-full flex flex-col justify-center items-center text-center animate-fade-up">
      <span class="text-primary font-bold tracking-[0.3em] uppercase text-sm mb-4 block">
        {pageData?.heroSubtitle || "Nuestra Alma"}
      </span>
      <h1 class="text-5xl md:text-8xl font-display font-black text-white mb-6 leading-tight">
        {pageData?.heroTitle || "Nuestra Historia"}
      </h1>
      <div class="w-24 h-1 bg-primary"></div>
    </Container>
  </section>

  {/* La Tradición */}
  <Section background="dark">
    <Container class="grid grid-cols-1 lg:grid-cols-2 gap-20 items-center">
      <div class="animate-fade-up">
        <h2 class="text-white font-serif text-5xl font-bold mb-8 italic">El Legado de <span class="text-primary not-italic">Warynessy</span></h2>
        <div class="space-y-6 text-white/70 text-lg font-light leading-relaxed">
           <p>
             Fundado hace décadas, Warynessy nació del sueño de llevar los sabores más puros del Mediterráneo a la mesa, manteniendo el respeto por el producto y la calidez del trato familiar.
           </p>
           <p>
             A lo largo de los años, hemos evolucionado, fusionando esa tradición heredada con las técnicas más vanguardistas, pero sin perder nunca nuestra esencia: la pasión por la excelencia.
           </p>
           <p>
             Cada ingrediente que entra en nuestra cocina es seleccionado personalmente, priorizando siempre la cercanía y la calidad.
           </p>
        </div>
      </div>
      <div class="relative">
         <div class="aspect-square rounded-2xl overflow-hidden shadow-2xl skew-y-3 hover:skew-y-0 transition-transform duration-700">
           <ResponsiveImage 
             src="https://images.unsplash.com/photo-1414235077428-338989a2e8c0?auto=format&fit=crop&q=80" 
             alt="Cocina de Warynessy" 
             class="h-full w-full object-cover"
           />
         </div>
         <div class="absolute -bottom-10 -left-10 w-48 h-48 bg-primary rounded-2xl -z-10 animate-pulse"></div>
      </div>
    </Container>
  </Section>

  {/* Valores / Timeline simple */}
  <Section background="none" class="bg-[#2B2621]">
    <Container>
      <div class="text-center mb-20 animate-fade-up">
        <h2 class="text-4xl font-serif font-bold text-white">Nuestra Filosofía</h2>
        <div class="w-16 h-1 bg-primary mx-auto mt-4"></div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-12 animate-stagger-container">
        {[
          {
            icon: "restaurant",
            title: "Producto Local",
            desc: "Trabajamos mano a mano con agricultores y pescadores de la zona para garantizar sabor y frescura."
          },
          {
            icon: "star_rate",
            title: "Excelencia",
            desc: "Buscamos la perfección en cada plato, desde la técnica culinaria hasta el emplatado final."
          },
          {
            icon: "groups",
            title: "Hospitalidad",
            desc: "Hacemos que cada cliente se sienta como en casa, ofreciendo un trato cercano y profesional."
          }
        ].map((item) => (
          <div class="bg-matte-black p-10 rounded-2xl border border-white/5 animate-stagger-item hover:-translate-y-2 transition-transform">
             <span class="material-symbols-outlined text-primary text-5xl mb-6">{item.icon}</span>
             <h3 class="text-white text-2xl font-bold mb-4">{item.title}</h3>
             <p class="text-white/50 leading-relaxed">{item.desc}</p>
          </div>
        ))}
      </div>
    </Container>
  </Section>

  {/* Reconocimientos / Sicted */}
  <Section background="dark">
    <Container class="text-center">
       <h2 class="text-3xl font-serif font-bold text-white mb-12">Compromiso con la Calidad</h2>
       <div class="flex flex-wrap justify-center items-center gap-16 opacity-50 grayscale hover:grayscale-0 hover:opacity-100 transition-all duration-500">
          <img src="/media/logo-sicted.png" alt="Compromiso Calidad Turística Sicted" class="h-24 object-contain" />
          <img src="/media/logo-guia-repsol.png" alt="Guía Repsol" class="h-16 object-contain" />
          <img src="/media/logo-alicante-gastronomica.png" alt="Alicante Gastronómica" class="h-20 object-contain" />
       </div>
    </Container>
  </Section>

  {/* Call to action */}
  <section class="py-24 bg-primary text-center">
     <Container class="animate-fade-up">
        <h2 class="text-white text-4xl md:text-5xl font-serif font-bold mb-8">¿Vienes a conocernos?</h2>
        <Button href="/reservas" variant="white" size="lg" class="text-primary hover:bg-black hover:text-white">
          Reserva tu experiencia
        </Button>
     </Container>
  </section>

</MainLayout>
