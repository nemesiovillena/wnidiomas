---
import MainLayout from '../layouts/MainLayout.astro';
import Section from '../components/ui/Section.astro';
import Container from '../components/ui/Container.astro';
import MenuCard from '../components/content/MenuCard.astro';
import { getSiteSettings, getMenus, getPaginaBySlug } from '../lib/payload-local';

const siteSettings = await getSiteSettings();
const menus = await getMenus();
const pageData = await getPaginaBySlug('menus');

const pageTitle = pageData?.metaTitle || `Menús | ${siteSettings?.title || "Warynessy"}`;
const pageDescription = pageData?.metaDescription || "Descubre nuestros menús degustación y opciones especiales.";

// Imagen Hero desde el CMS o fallback
const heroImg = typeof pageData?.heroImage === 'object' && pageData?.heroImage?.url 
  ? pageData.heroImage.url 
  : 'https://images.unsplash.com/photo-1544148103-0773bf10d330?auto=format&fit=crop&q=80';
---

<MainLayout title={pageTitle} description={pageDescription}>
  
  <section class="relative py-32 bg-matte-black overflow-hidden">
     <div class="absolute inset-0 bg-cover bg-center opacity-20" style={`background-image: url('${heroImg}')`}></div>
     <div class="absolute inset-0 bg-gradient-to-t from-matte-black to-transparent"></div>
     <Container class="relative z-10 text-center">
        <span class="text-primary font-bold tracking-[0.3em] uppercase text-sm mb-4 block">
          {pageData?.heroSubtitle || "Experiencias"}
        </span>
        <h1 class="text-5xl md:text-7xl font-display font-black text-white mb-6">
          {pageData?.heroTitle || "Menús Especiales"}
        </h1>
        <p class="text-white/60 text-lg max-w-2xl mx-auto font-light">
          {pageData?.heroSubtitle ? "" : "Propuestas diseñadas para compartir y disfrutar de la esencia de nuestra cocina."}
        </p>
     </Container>
  </section>

  <Section class="bg-matte-black min-h-screen">
    <Container>
      {menus.length > 0 ? (
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {menus.map((menu: any) => (
             <MenuCard menu={menu} />
          ))}
        </div>
      ) : (
        <div class="text-center py-20">
          <p class="text-white/40 text-xl">Próximamente nuevos menús de temporada.</p>
        </div>
      )}
    </Container>
  </Section>

</MainLayout>
